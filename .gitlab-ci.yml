cache:
  paths:
    - /root/.m2/repository

variables:
  DOCKER_IMAGE: "maven"
  DOCKER_TAG: "3.6.1-jdk-8"
  MAVEN_OPTS: "-Djava.awt.headless=true"
  MAVEN_CLI_OPTS: "--batch-mode --errors --fail-at-end --show-version -ntp"

stages:
  - deploy

maven_build:
  image: $DOCKER_IMAGE:$DOCKER_TAG
  stage: deploy
  script:
    - apt-get update && apt-get -y install zip
    - mvn -Dorg.slf4j.simpleLogger.defaultLogLevel=ERROR -B --show-version -ntp install -DskipTests
    - ./release_maven.sh
  when: manual